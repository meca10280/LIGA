<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>LIGA - Experiencia inmersiva</title>
    <script src="js/aframe.min.js"></script>
    <script src="js/aframe-ar.js"></script>   
  <style>
    body { margin: 0; overflow: hidden; }
    #info {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-family: Arial, sans-serif;
      font-size: 40px;
      color: #fff;
    }
  </style>
</head>
<body>
  <a-scene
    embedded
    arjs="sourceType: webcam; debugUIEnabled: false;"
  >
    <!-- Define multiple markers with distinct IDs -->
    <!-- Example using pattern markers; for barcode markers, change accordingly -->
    <a-marker id="marker1" type="pattern" url="patterns/00.patt" cursor="fuse" emitevents="true" registerevents>
      <!-- Optional: 3D content here -->
    </a-marker>

    <a-marker id="marker2" type="pattern" url="patterns/01.patt" cursor="fuse" emitevents="true" registerevents>
    </a-marker>

    <a-marker id="marker3" type="pattern" url="patterns/02.patt" cursor="fuse" emitevents="true" registerevents>
    </a-marker>

    <!-- Text entity that updates based on focused marker -->
    <a-entity
      id="dynamic-text"
      position="0 0.5 -1"
      text="value: Hover over a marker; align: center; width: 4;"
      geometry="primitive: plane; height: 0.3; width: 3;"
      material="color: #222; opacity: 0.8;"
      look-at="[camera]"
    ></a-entity>

    <!-- Camera -->
    <a-entity camera></a-entity>
  </a-scene>

  <div id="info">Point your camera at a marker to see details.</div>

  <script>
    // JavaScript to handle marker events
    document.addEventListener('DOMContentLoaded', () => {
      const marker1 = document.querySelector('#marker1');
      const marker2 = document.querySelector('#marker2');
      const marker3 = document.querySelector('#marker3');

      const dynamicText = document.querySelector('#dynamic-text');

      // Define marker focus states
      const markers = {
        marker1: {
          element: marker1,
          name: 'Marker 1',
          content: 'This is the content for Marker 1.',
        },
        marker2: {
          element: marker2,
          name: 'Marker 2',
          content: 'Welcome to Marker 2 area.',
        },
        marker3: {
          element: marker3,
          name: 'Marker 3',
          content: 'You are viewing Marker 3.',
        }
      };

      // Helper function to update text
      function updateText(content) {
        // Use a dark background with white text
        dynamicText.setAttribute('text', {
          value: content,
          align: 'center',
          width: 4,
        });
        // Update background color of the plane geometry
        dynamicText.setAttribute('material', {
          color: '#222',
          opacity: 0.8,
        });
      }

      // Add event listeners for marker detection
      Object.values(markers).forEach(marker => {
        marker.element.addEventListener('markerFound', () => {
          // When marker is detected, update the text
          updateText(marker.content);
        });
        marker.element.addEventListener('markerLost', () => {
          // Optional: reset text or do nothing
          // For example, show default message
          // updateText('Point your camera at a marker to see details.');
        });
      });
    });
  </script>
</body>
</html>
